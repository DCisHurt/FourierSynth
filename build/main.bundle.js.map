{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack://introduction-to-fourier-transforms/./src/js/color.js","webpack://introduction-to-fourier-transforms/./src/js/conductor.js","webpack://introduction-to-fourier-transforms/./src/js/controller/canvas-controller.js","webpack://introduction-to-fourier-transforms/./src/js/controller/controller-util.js","webpack://introduction-to-fourier-transforms/./src/js/controller/controller.js","webpack://introduction-to-fourier-transforms/./src/js/controller/wave-draw-controller.js","webpack://introduction-to-fourier-transforms/./src/js/controller/wave-split-controller.js","webpack://introduction-to-fourier-transforms/./src/js/fft.js","webpack://introduction-to-fourier-transforms/./src/js/just-fourier-things.js","webpack://introduction-to-fourier-transforms/./src/js/midi.js","webpack://introduction-to-fourier-transforms/./src/js/synth.js","webpack://introduction-to-fourier-transforms/./src/js/util.js","webpack://introduction-to-fourier-transforms/./src/js/wave-things.js","webpack://introduction-to-fourier-transforms/webpack/bootstrap","webpack://introduction-to-fourier-transforms/webpack/runtime/define property getters","webpack://introduction-to-fourier-transforms/webpack/runtime/hasOwnProperty shorthand","webpack://introduction-to-fourier-transforms/webpack/runtime/make namespace object","webpack://introduction-to-fourier-transforms/./src/js/main.js"],"sourcesContent":["import { clamp } from \"./util.js\";\r\n\r\nexport function rgb(r, g, b) {\r\n    return 'rgb('+r+','+g+','+b+')';\r\n}\r\n\r\nexport function grey(whiteAmt) {\r\n    whiteAmt = clamp(whiteAmt, 0, 1);\r\n    const whiteRgb = Math.floor(255 * whiteAmt);\r\n    return rgb(whiteRgb, whiteRgb, whiteRgb);\r\n}\r\n\r\nexport const palette = {\r\n    black: '#333',\r\n    blue: '#4657d7',\r\n    cyan: '#57a7cc',\r\n    pink: '#e91e63',\r\n    orange: '#ed7656',\r\n}","export default class Conductor {\r\n\r\n    constructor(controllers) {\r\n        this.lastTime = Date.now();\r\n        this.mousePosition = null;\r\n        this.controllers = controllers.slice();\r\n        this.updatingControllers = [];\r\n\r\n        // We can handle these all the same really.\r\n        document.addEventListener('mousemove', (evt) => this.updateMousePosition(evt));\r\n        document.addEventListener('mousedown', (evt) => this.updateMousePosition(evt));\r\n        document.addEventListener('mouseup',   (evt) => this.updateMousePosition(evt));\r\n\r\n        document.addEventListener('touchmove',  (evt) => this.updateTouchPosition(evt));\r\n        document.addEventListener('touchstart', (evt) => this.updateTouchPosition(evt));\r\n        document.addEventListener('touchend',   (evt) => this.updateTouchPosition(evt));\r\n\r\n        window.addEventListener('resize', (evt) => this.onResize(evt));\r\n    }\r\n\r\n    start() {\r\n        // Kick off the update loop\r\n        window.requestAnimationFrame(() => this.everyFrame());\r\n    }\r\n\r\n    onResize(evt) {\r\n        this.controllers.forEach(controller => {\r\n            if (typeof controller.onResize === 'function') {\r\n                controller.onResize();\r\n            }\r\n        })\r\n    }\r\n\r\n    everyFrame() {\r\n        this.update();\r\n        this.render();\r\n        requestAnimationFrame(() => this.everyFrame());\r\n    }\r\n\r\n    update() {\r\n        let curTime = Date.now();\r\n        let dt = (curTime - this.lastTime) / 1000;\r\n\r\n        this.updatingControllers = [];\r\n\r\n        this.controllers.forEach(controller => {\r\n            if (controller.isOnScreen()) {\r\n                controller.update(dt, this.mousePosition);\r\n                this.updatingControllers.push(controller);\r\n            }\r\n        });\r\n\r\n        this.lastTime = curTime;\r\n\r\n        const debug = document.getElementById('debug-content');\r\n        if (debug) {\r\n            debug.innerHTML = this.updatingControllers.map(c => c.id).join('<br>') + '<br>';\r\n        }\r\n    }\r\n\r\n    render() {\r\n        this.controllers.forEach(controller => {\r\n            if (controller.isOnScreen()) {\r\n                controller.render();\r\n            }\r\n        });\r\n    }\r\n\r\n    updateMousePosition(evt) {\r\n        this.mousePosition = { x: evt.clientX, y: evt.clientY };\r\n    }\r\n\r\n    updateTouchPosition(evt) {\r\n        if (evt.touches.length > 0) {\r\n            this.mousePosition = { x: evt.touches[0].clientX, y: evt.touches[0].clientY };\r\n        }\r\n    }\r\n\r\n}","import { elementInView, getScrollPosition } from \"./controller-util.js\";\r\nimport Controller from \"./controller.js\";\r\n\r\nexport default class CanvasController extends Controller {\r\n\r\n    constructor(id, width=null, height=null) {\r\n        super();\r\n        this.id = id;\r\n        this.canvas = document.getElementById(id);\r\n        if (width == null) {\r\n            width = this.canvas.width;\r\n        }\r\n        if (height == null) {\r\n            height = this.canvas.height;\r\n        }\r\n\r\n        /** @type {CanvasRenderingContext2D} */\r\n        this.context = this.canvas.getContext('2d');\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n    isOnScreen() {\r\n        return elementInView(this.canvas);\r\n    }\r\n\r\n    getScrollPosition() {\r\n        return getScrollPosition(this.canvas)\r\n    }\r\n\r\n    clear() {\r\n        // Clear the previous frame\r\n        this.context.resetTransform();\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n}\r\n","export function getScrollPosition(elem) {\r\n    const boundingRect = elem.getBoundingClientRect();\r\n    const centerY = (boundingRect.top + boundingRect.bottom) / 2;\r\n    const windowHeight = (window.innerHeight || document.documentElement.clientHeight)\r\n    return centerY / windowHeight;\r\n}\r\n\r\nexport function elementInView(elem) {\r\n    // Thanks stack overflow https://stackoverflow.com/a/7557433\r\n    const boundingRect = elem.getBoundingClientRect();\r\n\r\n    return (\r\n        boundingRect.bottom >= 0 &&\r\n        boundingRect.top <= (window.innerHeight || document.documentElement.clientHeight) &&\r\n        boundingRect.right >= 0 &&\r\n        boundingRect.left <= (window.innerWidth || document.documentElement.clientWidth)\r\n    );\r\n}","export default class Controller {\r\n\r\n    update(dt, mousePosition) {\r\n        // nothing.\r\n    }\r\n\r\n    isOnScreen() {\r\n        return true;\r\n    }\r\n\r\n    render() {\r\n        // nothing.\r\n    }\r\n\r\n}\r\n","import CanvasController from \"./canvas-controller.js\";\r\nimport { slurp } from \"../util.js\";\r\nimport { palette } from \"../color.js\";\r\n\r\nexport default class WaveDrawController extends CanvasController {\r\n\r\n    constructor(id, width, height) {\r\n        super(id, width, height);\r\n        // just a list\r\n        this.wavePoints = new Array(128).fill(this.height / 2);\r\n\r\n        this.drawing = false;\r\n        this.onDrawingStart = [];\r\n        this.onDrawingEnd = [];\r\n        this.lastMousePoint = null;\r\n\r\n        this.canvas.addEventListener('mousedown', () => this.startDrawing());\r\n        this.canvas.addEventListener('touchstart', () => this.startDrawing());\r\n\r\n        document.addEventListener('mouseup', () => this.stopDrawing());\r\n        document.addEventListener('touchend', () => this.stopDrawing());\r\n\r\n        // Prevent scrolling while we're drawing here\r\n        this.canvas.addEventListener('touchmove', (evt) => evt.preventDefault(), {passive: false});\r\n    }\r\n\r\n    get normPath() {\r\n        return this.wavePoints.map(el => el / this.height)\r\n    }\r\n\r\n    startDrawing() {\r\n        this.drawing = true;\r\n        this.lastMousePoint = null;\r\n\r\n        this.onDrawingStart.forEach(fn => fn());\r\n    }\r\n\r\n    stopDrawing() {\r\n        if (this.drawing) {\r\n            this.drawing = false;\r\n            this.lastMousePoint = null;\r\n\r\n            this.onDrawingEnd.forEach(fn => fn());\r\n        }\r\n    }\r\n\r\n     update(dt, mousePosition) {\r\n        if (!mousePosition || !this.drawing) {\r\n            return;\r\n        }\r\n\r\n        const canvasPosition = this.canvas.getBoundingClientRect();\r\n        // we have to account for the border here too\r\n        const actualWidth = (canvasPosition.right - canvasPosition.left) - 2;\r\n        // 500 being the 'default' width\r\n        const scale = 500 / actualWidth;\r\n        const mousePoint = {\r\n            x: scale * (mousePosition.x - canvasPosition.x),\r\n            y: scale * (mousePosition.y - canvasPosition.y),\r\n        }\r\n        if (this.lastMousePoint == null) {\r\n            this.lastMousePoint = mousePoint;\r\n        }\r\n\r\n        const xDiff = Math.abs(mousePoint.x - this.lastMousePoint.x);\r\n        const pointsGap = this.width / this.wavePoints.length;\r\n        const lerpPoints = 2 * Math.ceil(xDiff / pointsGap) + 1;\r\n        for (let i = 0; i < lerpPoints; i ++) {\r\n            const amt = (i - 1) / lerpPoints;\r\n\r\n            const index = this.getNearestIndex(slurp(this.lastMousePoint.x, mousePoint.x, amt));\r\n            this.wavePoints[index] = slurp(this.lastMousePoint.y, mousePoint.y, amt);\r\n        }\r\n\r\n        this.lastMousePoint = mousePoint;\r\n    }\r\n\r\n    /**\r\n     * Gets the nearest index in the wave array to the x coord on the screen\r\n     * @param {Number} x\r\n     */\r\n    getNearestIndex(x) {\r\n        const xAmt = (x / this.width)\r\n        let pos = Math.round(this.wavePoints.length * xAmt) % this.wavePoints.length;\r\n        if (pos < 0) {\r\n            pos += this.wavePoints.length;\r\n        }\r\n        return pos;\r\n    }\r\n\r\n    render() {\r\n        this.clear();\r\n\r\n        this.renderWave();\r\n    }\r\n\r\n    renderWave() {\r\n        this.context.beginPath();\r\n        this.context.lineWidth = 2;\r\n        this.context.strokeStyle = palette.pink;\r\n        for (let i = 0; i <= this.wavePoints.length; i ++) {\r\n            const index = i % this.wavePoints.length;\r\n            const amt = i / this.wavePoints.length;\r\n\r\n            const x = this.width * amt;\r\n            const y = this.wavePoints[index];\r\n\r\n            if (i == 0) {\r\n                this.context.moveTo(x, y);\r\n            }\r\n            else {\r\n                this.context.lineTo(x, y);\r\n            }\r\n        }\r\n        this.context.stroke();\r\n    }\r\n}\r\n","import CanvasController from \"./canvas-controller.js\";\r\nimport { slurp } from \"../util.js\";\r\nimport { getRealFourierData } from \"../just-fourier-things.js\";\r\nimport { palette } from \"../color.js\";\r\nimport { renderWave } from \"../wave-things.js\";\r\n\r\nconst transitionFactor = (1 / 15);\r\n\r\nexport default class WaveSplitController extends CanvasController {\r\n\r\n    constructor(id, width, height) {\r\n        super(id, width, height);\r\n\r\n        this.animAmt = 0;\r\n        this.wavePoints = [];\r\n        this.partialWave = [];\r\n        this.fourierPoints = [];\r\n\r\n        this.onFourierChange = []\r\n\r\n        this.waveTop = 0;\r\n        this.waveBottom = 0;\r\n        this.totalHeight = 0;\r\n        this.fadeFrequencies = true;\r\n        this.splitAnim = true;\r\n        // How many of the waves to draw\r\n        this.fourierAmt = 1;\r\n    }\r\n\r\n    setPath(path) {\r\n        // Update the wave points. For the sake of removing the constant term in the FFT,\r\n        // Set the mean to be 0.\r\n        const pathAverage = path.reduce((a, b) => a + b, 0) / path.length;\r\n        this.wavePoints = path.map(p => p - pathAverage);\r\n        // Calculate fourier points, and drop the small things.\r\n        this.fourierData = getRealFourierData(this.wavePoints).filter(f => f.amplitude > 0.001);\r\n        this.fourierData.sort((a, b) => b.amplitude - a.amplitude);\r\n\r\n        // Calculate the heights of the main wave and all the sine things\r\n        this.waveTop = Math.min(...this.wavePoints);\r\n        this.waveBottom = Math.max(...this.wavePoints);\r\n\r\n        // Total height. Start with the main wave...\r\n        this.totalHeight = this.waveBottom - this.waveTop;\r\n        // Then add all the sine thingos\r\n        this.fourierData.forEach((el) => this.totalHeight += 2 * el.amplitude);\r\n\r\n        // reset the animation too\r\n        this.animAmt = 0;\r\n        this.splitAmt = 0;\r\n\r\n        this.onFourierChange.forEach(fn => fn());\r\n    }\r\n\r\n    update(dt, mousePosition) {\r\n        const period = 7;\r\n        this.animAmt += dt / period;\r\n        this.animAmt %= 1;\r\n\r\n        const pos = this.getScrollPosition();\r\n        let desiredSplitAmt = 0;\r\n        if (pos < 0.7) {\r\n            desiredSplitAmt = 1;\r\n        }\r\n        this.splitAmt += transitionFactor * (desiredSplitAmt - this.splitAmt);\r\n    }\r\n\r\n    render() {\r\n        this.clear();\r\n        this.renderWaves();\r\n    }\r\n\r\n    renderWaves() {\r\n        if (this.wavePoints.length == 0) {\r\n            return;\r\n        }\r\n        this.context.strokeStyle = palette.cyan;\r\n        this.context.lineWidth = 2;\r\n\r\n        const numBabies = Math.min(50, this.fourierData.length);\r\n        const top = 0.1 * this.context.canvas.height;\r\n        const bottom = 0.9 * this.context.canvas.height;\r\n        // TODO: also incorporate into the frequencies to scale that too?\r\n        const sizeMultiple = (bottom - top) / this.totalHeight;\r\n        const spacingMultiplier = 0.8;\r\n\r\n        // Running thing that says where to draw each wave.\r\n        let curWavePos = 0;\r\n\r\n        let startXAmt = -this.animAmt;\r\n\r\n        let splitAmt = 1;\r\n        let fadeAmt = 1;\r\n        if (this.splitAnim) {\r\n            splitAmt = this.splitAmt;\r\n            fadeAmt = splitAmt;\r\n        }\r\n\r\n        // Actually, we're going to skip drawing the main wave here and draw it later.\r\n        curWavePos += this.waveBottom - this.waveTop;\r\n\r\n        // Draw its little babies.\r\n        // Also sum up their values to draw the partial wave.\r\n\r\n        this.partialWave = this.wavePoints.slice().fill(0);\r\n        const renderedBabies = Math.round(slurp(1, numBabies, this.fourierAmt));\r\n        for (let babe = 0; babe < renderedBabies; babe ++) {\r\n            let babeAmt = babe / (numBabies - 1);\r\n            const waveData = this.fourierData[babe];\r\n            curWavePos += waveData.amplitude;\r\n            const wavePosition = slurp(-this.waveTop, curWavePos, splitAmt);\r\n\r\n            // lets generate this wave hey\r\n            // TODO: cache this?\r\n            const wave = this.wavePoints.slice();\r\n            for (let i = 0; i < this.wavePoints.length; i ++) {\r\n                const iAmt = i / this.wavePoints.length;\r\n                const fullWaveAmt = this.wavePoints[i];\r\n                const sineAmt = waveData.amplitude * Math.cos(2 * Math.PI * waveData.freq * iAmt + waveData.phase);\r\n                wave[i] = slurp(fullWaveAmt, sineAmt, splitAmt);\r\n\r\n                // While we're here, update the partial wave\r\n                this.partialWave[i] += wave[i];\r\n            }\r\n\r\n            this.context.beginPath();\r\n            this.context.globalAlpha = fadeAmt;\r\n            if (this.fadeFrequencies) {\r\n                this.context.globalAlpha *= (1 - babeAmt);\r\n            }\r\n            renderWave({\r\n                context: this.context,\r\n                width: this.width,\r\n                wave: wave,\r\n                yPosition: top + sizeMultiple * wavePosition,\r\n                yMultiple: sizeMultiple * spacingMultiplier,\r\n                startXAmt: startXAmt\r\n            });\r\n            this.context.stroke();\r\n            this.context.globalAlpha = 1;\r\n\r\n            curWavePos += waveData.amplitude;\r\n        }\r\n\r\n        curWavePos = 0;\r\n        curWavePos -= this.waveTop;\r\n        if (this.fourierAmt == 1) {\r\n            // Eh just make it the full wave.\r\n            this.partialWave = this.wavePoints;\r\n        }\r\n\r\n        // Now, lets go back and draw the main wave\r\n        // Draw the main boy\r\n        this.context.strokeStyle = palette.blue;\r\n        this.context.lineWidth = 2;\r\n        this.context.beginPath();\r\n        renderWave({\r\n            context: this.context,\r\n            width: this.width,\r\n            wave: this.partialWave,\r\n            yPosition: top + sizeMultiple * curWavePos,\r\n            yMultiple: sizeMultiple * spacingMultiplier,\r\n            startXAmt: startXAmt\r\n        });\r\n        this.context.stroke();\r\n    }\r\n\r\n}","\r\nexport default class Conductor {\r\n  constructor(size) {\r\n    this.size = size | 0;\r\n    if (this.size <= 1 || (this.size & (this.size - 1)) !== 0)\r\n      throw new Error('FFT size must be a power of two and bigger than 1');\r\n\r\n    this._csize = size << 1;\r\n\r\n    // NOTE: Use of `var` is intentional for old V8 versions\r\n    var table = new Array(this.size * 2);\r\n    for (var i = 0; i < table.length; i += 2) {\r\n      const angle = Math.PI * i / this.size;\r\n      table[i] = Math.cos(angle);\r\n      table[i + 1] = -Math.sin(angle);\r\n    }\r\n    this.table = table;\r\n\r\n    // Find size's power of two\r\n    var power = 0;\r\n    for (var t = 1; this.size > t; t <<= 1)\r\n      power++;\r\n\r\n    // Calculate initial step's width:\r\n    //   * If we are full radix-4 - it is 2x smaller to give inital len=8\r\n    //   * Otherwise it is the same as `power` to give len=4\r\n    this._width = power % 2 === 0 ? power - 1 : power;\r\n\r\n    // Pre-compute bit-reversal patterns\r\n    this._bitrev = new Array(1 << this._width);\r\n    for (var j = 0; j < this._bitrev.length; j++) {\r\n      this._bitrev[j] = 0;\r\n      for (var shift = 0; shift < this._width; shift += 2) {\r\n        var revShift = this._width - shift - 2;\r\n        this._bitrev[j] |= ((j >>> shift) & 3) << revShift;\r\n      }\r\n    }\r\n\r\n    this._out = null;\r\n    this._data = null;\r\n    this._inv = 0;\r\n  }\r\n  // module.exports = FFT;\r\n\r\n  fromComplexArray(complex, storage) {\r\n    var res = storage || new Array(complex.length >>> 1);\r\n    for (var i = 0; i < complex.length; i += 2)\r\n      res[i >>> 1] = complex[i];\r\n    return res;\r\n  };\r\n\r\n  createComplexArray() {\r\n    const res = new Array(this._csize);\r\n    for (var i = 0; i < res.length; i++)\r\n      res[i] = 0;\r\n    return res;\r\n  };\r\n\r\n  toComplexArray(input, storage) {\r\n    var res = storage || this.createComplexArray();\r\n    for (var i = 0; i < res.length; i += 2) {\r\n      res[i] = input[i >>> 1];\r\n      res[i + 1] = 0;\r\n    }\r\n    return res;\r\n  };\r\n\r\n  completeSpectrum(spectrum) {\r\n    var size = this._csize;\r\n    var half = size >>> 1;\r\n    for (var i = 2; i < half; i += 2) {\r\n      spectrum[size - i] = spectrum[i];\r\n      spectrum[size - i + 1] = -spectrum[i + 1];\r\n    }\r\n  };\r\n\r\n  transform(out, data) {\r\n    if (out === data)\r\n      throw new Error('Input and output buffers must be different');\r\n\r\n    this._out = out;\r\n    this._data = data;\r\n    this._inv = 0;\r\n    this._transform4();\r\n    this._out = null;\r\n    this._data = null;\r\n  };\r\n\r\n  realTransform(out, data) {\r\n    if (out === data)\r\n      throw new Error('Input and output buffers must be different');\r\n\r\n    this._out = out;\r\n    this._data = data;\r\n    this._inv = 0;\r\n    this._realTransform4();\r\n    this._out = null;\r\n    this._data = null;\r\n  };\r\n\r\n  inverseTransform(out, data) {\r\n    if (out === data)\r\n      throw new Error('Input and output buffers must be different');\r\n\r\n    this._out = out;\r\n    this._data = data;\r\n    this._inv = 1;\r\n    this._transform4();\r\n    for (var i = 0; i < out.length; i++)\r\n      out[i] /= this.size;\r\n    this._out = null;\r\n    this._data = null;\r\n  };\r\n\r\n  // radix-4 implementation\r\n  //\r\n  // NOTE: Uses of `var` are intentional for older V8 version that do not\r\n  // support both `let compound assignments` and `const phi`\r\n  _transform4() {\r\n    var out = this._out;\r\n    var size = this._csize;\r\n\r\n    // Initial step (permute and transform)\r\n    var width = this._width;\r\n    var step = 1 << width;\r\n    var len = (size / step) << 1;\r\n\r\n    var outOff;\r\n    var t;\r\n    var bitrev = this._bitrev;\r\n    if (len === 4) {\r\n      for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\r\n        const off = bitrev[t];\r\n        this._singleTransform2(outOff, off, step);\r\n      }\r\n    } else {\r\n      // len === 8\r\n      for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\r\n        const off = bitrev[t];\r\n        this._singleTransform4(outOff, off, step);\r\n      }\r\n    }\r\n\r\n    // Loop through steps in decreasing order\r\n    var inv = this._inv ? -1 : 1;\r\n    var table = this.table;\r\n    for (step >>= 2; step >= 2; step >>= 2) {\r\n      len = (size / step) << 1;\r\n      var quarterLen = len >>> 2;\r\n\r\n      // Loop through offsets in the data\r\n      for (outOff = 0; outOff < size; outOff += len) {\r\n        // Full case\r\n        var limit = outOff + quarterLen;\r\n        for (var i = outOff, k = 0; i < limit; i += 2, k += step) {\r\n          const A = i;\r\n          const B = A + quarterLen;\r\n          const C = B + quarterLen;\r\n          const D = C + quarterLen;\r\n\r\n          // Original values\r\n          const Ar = out[A];\r\n          const Ai = out[A + 1];\r\n          const Br = out[B];\r\n          const Bi = out[B + 1];\r\n          const Cr = out[C];\r\n          const Ci = out[C + 1];\r\n          const Dr = out[D];\r\n          const Di = out[D + 1];\r\n\r\n          // Middle values\r\n          const MAr = Ar;\r\n          const MAi = Ai;\r\n\r\n          const tableBr = table[k];\r\n          const tableBi = inv * table[k + 1];\r\n          const MBr = Br * tableBr - Bi * tableBi;\r\n          const MBi = Br * tableBi + Bi * tableBr;\r\n\r\n          const tableCr = table[2 * k];\r\n          const tableCi = inv * table[2 * k + 1];\r\n          const MCr = Cr * tableCr - Ci * tableCi;\r\n          const MCi = Cr * tableCi + Ci * tableCr;\r\n\r\n          const tableDr = table[3 * k];\r\n          const tableDi = inv * table[3 * k + 1];\r\n          const MDr = Dr * tableDr - Di * tableDi;\r\n          const MDi = Dr * tableDi + Di * tableDr;\r\n\r\n          // Pre-Final values\r\n          const T0r = MAr + MCr;\r\n          const T0i = MAi + MCi;\r\n          const T1r = MAr - MCr;\r\n          const T1i = MAi - MCi;\r\n          const T2r = MBr + MDr;\r\n          const T2i = MBi + MDi;\r\n          const T3r = inv * (MBr - MDr);\r\n          const T3i = inv * (MBi - MDi);\r\n\r\n          // Final values\r\n          const FAr = T0r + T2r;\r\n          const FAi = T0i + T2i;\r\n\r\n          const FCr = T0r - T2r;\r\n          const FCi = T0i - T2i;\r\n\r\n          const FBr = T1r + T3i;\r\n          const FBi = T1i - T3r;\r\n\r\n          const FDr = T1r - T3i;\r\n          const FDi = T1i + T3r;\r\n\r\n          out[A] = FAr;\r\n          out[A + 1] = FAi;\r\n          out[B] = FBr;\r\n          out[B + 1] = FBi;\r\n          out[C] = FCr;\r\n          out[C + 1] = FCi;\r\n          out[D] = FDr;\r\n          out[D + 1] = FDi;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // radix-2 implementation\r\n  //\r\n  // NOTE: Only called for len=4\r\n  _singleTransform2(outOff, off,\r\n                                                                step) {\r\n    const out = this._out;\r\n    const data = this._data;\r\n\r\n    const evenR = data[off];\r\n    const evenI = data[off + 1];\r\n    const oddR = data[off + step];\r\n    const oddI = data[off + step + 1];\r\n\r\n    const leftR = evenR + oddR;\r\n    const leftI = evenI + oddI;\r\n    const rightR = evenR - oddR;\r\n    const rightI = evenI - oddI;\r\n\r\n    out[outOff] = leftR;\r\n    out[outOff + 1] = leftI;\r\n    out[outOff + 2] = rightR;\r\n    out[outOff + 3] = rightI;\r\n  };\r\n\r\n  // radix-4\r\n  //\r\n  // NOTE: Only called for len=8\r\n  _singleTransform4(outOff, off, step) {\r\n    const out = this._out;\r\n    const data = this._data;\r\n    const inv = this._inv ? -1 : 1;\r\n    const step2 = step * 2;\r\n    const step3 = step * 3;\r\n\r\n    // Original values\r\n    const Ar = data[off];\r\n    const Ai = data[off + 1];\r\n    const Br = data[off + step];\r\n    const Bi = data[off + step + 1];\r\n    const Cr = data[off + step2];\r\n    const Ci = data[off + step2 + 1];\r\n    const Dr = data[off + step3];\r\n    const Di = data[off + step3 + 1];\r\n\r\n    // Pre-Final values\r\n    const T0r = Ar + Cr;\r\n    const T0i = Ai + Ci;\r\n    const T1r = Ar - Cr;\r\n    const T1i = Ai - Ci;\r\n    const T2r = Br + Dr;\r\n    const T2i = Bi + Di;\r\n    const T3r = inv * (Br - Dr);\r\n    const T3i = inv * (Bi - Di);\r\n\r\n    // Final values\r\n    const FAr = T0r + T2r;\r\n    const FAi = T0i + T2i;\r\n\r\n    const FBr = T1r + T3i;\r\n    const FBi = T1i - T3r;\r\n\r\n    const FCr = T0r - T2r;\r\n    const FCi = T0i - T2i;\r\n\r\n    const FDr = T1r - T3i;\r\n    const FDi = T1i + T3r;\r\n\r\n    out[outOff] = FAr;\r\n    out[outOff + 1] = FAi;\r\n    out[outOff + 2] = FBr;\r\n    out[outOff + 3] = FBi;\r\n    out[outOff + 4] = FCr;\r\n    out[outOff + 5] = FCi;\r\n    out[outOff + 6] = FDr;\r\n    out[outOff + 7] = FDi;\r\n  };\r\n\r\n  // Real input radix-4 implementation\r\n  _realTransform4() {\r\n    var out = this._out;\r\n    var size = this._csize;\r\n\r\n    // Initial step (permute and transform)\r\n    var width = this._width;\r\n    var step = 1 << width;\r\n    var len = (size / step) << 1;\r\n\r\n    var outOff;\r\n    var t;\r\n    var bitrev = this._bitrev;\r\n    if (len === 4) {\r\n      for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\r\n        const off = bitrev[t];\r\n        this._singleRealTransform2(outOff, off >>> 1, step >>> 1);\r\n      }\r\n    } else {\r\n      // len === 8\r\n      for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\r\n        const off = bitrev[t];\r\n        this._singleRealTransform4(outOff, off >>> 1, step >>> 1);\r\n      }\r\n    }\r\n\r\n    // Loop through steps in decreasing order\r\n    var inv = this._inv ? -1 : 1;\r\n    var table = this.table;\r\n    for (step >>= 2; step >= 2; step >>= 2) {\r\n      len = (size / step) << 1;\r\n      var halfLen = len >>> 1;\r\n      var quarterLen = halfLen >>> 1;\r\n      var hquarterLen = quarterLen >>> 1;\r\n\r\n      // Loop through offsets in the data\r\n      for (outOff = 0; outOff < size; outOff += len) {\r\n        for (var i = 0, k = 0; i <= hquarterLen; i += 2, k += step) {\r\n          var A = outOff + i;\r\n          var B = A + quarterLen;\r\n          var C = B + quarterLen;\r\n          var D = C + quarterLen;\r\n\r\n          // Original values\r\n          var Ar = out[A];\r\n          var Ai = out[A + 1];\r\n          var Br = out[B];\r\n          var Bi = out[B + 1];\r\n          var Cr = out[C];\r\n          var Ci = out[C + 1];\r\n          var Dr = out[D];\r\n          var Di = out[D + 1];\r\n\r\n          // Middle values\r\n          var MAr = Ar;\r\n          var MAi = Ai;\r\n\r\n          var tableBr = table[k];\r\n          var tableBi = inv * table[k + 1];\r\n          var MBr = Br * tableBr - Bi * tableBi;\r\n          var MBi = Br * tableBi + Bi * tableBr;\r\n\r\n          var tableCr = table[2 * k];\r\n          var tableCi = inv * table[2 * k + 1];\r\n          var MCr = Cr * tableCr - Ci * tableCi;\r\n          var MCi = Cr * tableCi + Ci * tableCr;\r\n\r\n          var tableDr = table[3 * k];\r\n          var tableDi = inv * table[3 * k + 1];\r\n          var MDr = Dr * tableDr - Di * tableDi;\r\n          var MDi = Dr * tableDi + Di * tableDr;\r\n\r\n          // Pre-Final values\r\n          var T0r = MAr + MCr;\r\n          var T0i = MAi + MCi;\r\n          var T1r = MAr - MCr;\r\n          var T1i = MAi - MCi;\r\n          var T2r = MBr + MDr;\r\n          var T2i = MBi + MDi;\r\n          var T3r = inv * (MBr - MDr);\r\n          var T3i = inv * (MBi - MDi);\r\n\r\n          // Final values\r\n          var FAr = T0r + T2r;\r\n          var FAi = T0i + T2i;\r\n\r\n          var FBr = T1r + T3i;\r\n          var FBi = T1i - T3r;\r\n\r\n          out[A] = FAr;\r\n          out[A + 1] = FAi;\r\n          out[B] = FBr;\r\n          out[B + 1] = FBi;\r\n\r\n          // Output final middle point\r\n          if (i === 0) {\r\n            var FCr = T0r - T2r;\r\n            var FCi = T0i - T2i;\r\n            out[C] = FCr;\r\n            out[C + 1] = FCi;\r\n            continue;\r\n          }\r\n\r\n          // Do not overwrite ourselves\r\n          if (i === hquarterLen)\r\n            continue;\r\n\r\n          // In the flipped case:\r\n          // MAi = -MAi\r\n          // MBr=-MBi, MBi=-MBr\r\n          // MCr=-MCr\r\n          // MDr=MDi, MDi=MDr\r\n          var ST0r = T1r;\r\n          var ST0i = -T1i;\r\n          var ST1r = T0r;\r\n          var ST1i = -T0i;\r\n          var ST2r = -inv * T3i;\r\n          var ST2i = -inv * T3r;\r\n          var ST3r = -inv * T2i;\r\n          var ST3i = -inv * T2r;\r\n\r\n          var SFAr = ST0r + ST2r;\r\n          var SFAi = ST0i + ST2i;\r\n\r\n          var SFBr = ST1r + ST3i;\r\n          var SFBi = ST1i - ST3r;\r\n\r\n          var SA = outOff + quarterLen - i;\r\n          var SB = outOff + halfLen - i;\r\n\r\n          out[SA] = SFAr;\r\n          out[SA + 1] = SFAi;\r\n          out[SB] = SFBr;\r\n          out[SB + 1] = SFBi;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // radix-2 implementation\r\n  //\r\n  // NOTE: Only called for len=4\r\n  _singleRealTransform2(outOff,\r\n                                                                        off,\r\n                                                                        step) {\r\n    const out = this._out;\r\n    const data = this._data;\r\n\r\n    const evenR = data[off];\r\n    const oddR = data[off + step];\r\n\r\n    const leftR = evenR + oddR;\r\n    const rightR = evenR - oddR;\r\n\r\n    out[outOff] = leftR;\r\n    out[outOff + 1] = 0;\r\n    out[outOff + 2] = rightR;\r\n    out[outOff + 3] = 0;\r\n  };\r\n\r\n  // radix-4\r\n  //\r\n  // NOTE: Only called for len=8\r\n  _singleRealTransform4(outOff,\r\n                                                                        off,\r\n                                                                        step) {\r\n    const out = this._out;\r\n    const data = this._data;\r\n    const inv = this._inv ? -1 : 1;\r\n    const step2 = step * 2;\r\n    const step3 = step * 3;\r\n\r\n    // Original values\r\n    const Ar = data[off];\r\n    const Br = data[off + step];\r\n    const Cr = data[off + step2];\r\n    const Dr = data[off + step3];\r\n\r\n    // Pre-Final values\r\n    const T0r = Ar + Cr;\r\n    const T1r = Ar - Cr;\r\n    const T2r = Br + Dr;\r\n    const T3r = inv * (Br - Dr);\r\n\r\n    // Final values\r\n    const FAr = T0r + T2r;\r\n\r\n    const FBr = T1r;\r\n    const FBi = -T3r;\r\n\r\n    const FCr = T0r - T2r;\r\n\r\n    const FDr = T1r;\r\n    const FDi = T3r;\r\n\r\n    out[outOff] = FAr;\r\n    out[outOff + 1] = 0;\r\n    out[outOff + 2] = FBr;\r\n    out[outOff + 3] = FBi;\r\n    out[outOff + 4] = FCr;\r\n    out[outOff + 5] = 0;\r\n    out[outOff + 6] = FDr;\r\n    out[outOff + 7] = FDi;\r\n  };\r\n}","import FFT from './fft.js';\r\nimport { slurp } from \"./util.js\";\r\n\r\n/**\r\n * Do the fourier thing using a bunch of complex points\r\n *\r\n * @param {Array<Number>} points Array of points, alternative with re, im pairs. Length must be a power of 2\r\n */\r\nexport function getFourierData(points) {\r\n    if (points.length == 0) {\r\n        return [];\r\n    }\r\n    const numPoints = points.length / 2;\r\n    const fft = new FFT(numPoints);\r\n\r\n    const out = fft.createComplexArray();\r\n    fft.transform(out, points);\r\n\r\n    // Transform into an API of points I find friendlier.\r\n    const fftData = [];\r\n    for (let i = 0; i < numPoints; i ++) {\r\n        // to reorder the frequencies a little nicer, we pick from the front and back altermatively\r\n        const j = i % 2 == 0 ? i / 2 : numPoints - ((i+1) / 2);\r\n        const x = out[2 * j];\r\n        const y = out[2 * j + 1];\r\n        const freq = ((j + numPoints / 2) % numPoints) - numPoints / 2;\r\n        fftData.push({\r\n            freq: freq,\r\n            // a little expensive\r\n            amplitude: Math.sqrt(x * x + y * y) / numPoints,\r\n            // a lottle expensive :(\r\n            phase: Math.atan2(y, x),\r\n        });\r\n    }\r\n    // fftData.sort((a, b) => b.amplitude - a.amplitude);\r\n    return fftData;\r\n}\r\n\r\n/**\r\n *\r\n * @param {Array<Number>} points Array of values of some wave. Must be a power of 2.\r\n */\r\nexport function getRealFourierData(points) {\r\n    if (points.length == 0) {\r\n        return [];\r\n    }\r\n    const numPoints = points.length;\r\n    const fft = new FFT(numPoints);\r\n\r\n    const formatedPoints = fft.createComplexArray();\r\n    fft.toComplexArray(points, formatedPoints);\r\n\r\n    const out = fft.createComplexArray();\r\n    fft.transform(out, formatedPoints);\r\n\r\n    // Transform into an API of points I find friendlier.\r\n    const fftData = [];\r\n    // We only have to read the first half of this because of symmetry things.\r\n    for (let i = 0; i < numPoints / 2; i ++) {\r\n        const x = out[2 * i];\r\n        const y = out[2 * i + 1];\r\n        const freq = i;\r\n        fftData.push({\r\n            freq: freq,\r\n            // a little expensive\r\n            // Also we gotta multiply this by 2 to account for the other side that\r\n            amplitude: 2 * Math.sqrt(x * x + y * y) / numPoints,\r\n            // a lottle expensive :(\r\n            phase: Math.atan2(y, x),\r\n        });\r\n    }\r\n    // fftData.sort((a, b) => b.amplitude - a.amplitude);\r\n    return fftData;\r\n}\r\n\r\n/**\r\n * Transforms a list of x, y points into input appropriate for a fourier transform.\r\n */\r\nexport function resample2dData(points, numSamples) {\r\n    if (points.length == 0) {\r\n        // Can't resample if we don't have ANY points\r\n        return [];\r\n    }\r\n    let newPoints = [];\r\n    for (let i = 0; i < numSamples; i ++) {\r\n        let position = points.length * (i / numSamples);\r\n        let index = Math.floor(position);\r\n        let nextIndex = (index + 1) % points.length;\r\n        let amt = position - index;\r\n        newPoints.push(\r\n            /* x */ slurp(points[index].x, points[nextIndex].x, amt),\r\n            /* y */ slurp(points[index].y, points[nextIndex].y, amt),\r\n        )\r\n    }\r\n    return newPoints;\r\n}\r\n\r\n/**\r\n * Do the fourier thing using a bunch of complex points\r\n *\r\n * @param {Array<Number>} points Array of points, alternative with re, im pairs. Length must be a power of 2\r\n */\r\nexport function getFourierRI(points) {\r\n    if (points.length == 0) {\r\n        return [];\r\n    }\r\n    const numPoints = points.length / 2;\r\n    const fft = new FFT(numPoints);\r\n\r\n    const out = fft.createComplexArray();\r\n    fft.toComplexArray(points,out);\r\n\r\n\r\n    console.log(out)\r\n    // Transform into an API of points I find friendlier.\r\n    // const fftData = [];\r\n    // for (let i = 0; i < numPoints; i ++) {\r\n    //     // to reorder the frequencies a little nicer, we pick from the front and back altermatively\r\n    //     const j = i % 2 == 0 ? i / 2 : numPoints - ((i+1) / 2);\r\n    //     const x = out[2 * j];\r\n    //     const y = out[2 * j + 1];\r\n    //     const freq = ((j + numPoints / 2) % numPoints) - numPoints / 2;\r\n    //     fftData.push({\r\n    //         freq: freq,\r\n    //         // a little expensive\r\n    //         amplitude: Math.sqrt(x * x + y * y) / numPoints,\r\n    //         // a lottle expensive :(\r\n    //         phase: Math.atan2(y, x),\r\n    //     });\r\n    // }\r\n    // // fftData.sort((a, b) => b.amplitude - a.amplitude);\r\n    return out;\r\n}","import { playSoundWave, stopSoundWave, pitchShift, volumeShift } from './synth.js';\r\n\r\nexport let nPiontsCC = [];\r\nexport let cutoffCC = [];\r\nexport let resonanceCC = [];\r\nexport let delayTimeCC = [];\r\nexport let delayWetCC = [];\r\nexport let attackCC = [];\r\nexport let decayCC = [];\r\nexport let driveCC = [];\r\nexport let masterVolCC = [];\r\n\r\nexport function connectMidi() {\r\n\r\n    navigator.requestMIDIAccess()\r\n    .then(\r\n        (midi) => midiReady(midi),\r\n        (err) => console.log('Something went wrong', err));\r\n}\r\n  \r\nfunction midiReady(midi) {\r\n    // Also react to device changes.\r\n    midi.addEventListener('statechange', (event) => initDevices(event.target));\r\n    initDevices(midi); // see the next section!\r\n}\r\n\r\n\r\nfunction initDevices(midi) {\r\n    // Reset.\r\n    let midiIn = [];\r\n    let midiOut = [];\r\n\r\n    // MIDI devices that send you data.\r\n    const inputs = midi.inputs.values();\r\n    for (let input = inputs.next(); input && !input.done; input = inputs.next()) {\r\n        midiIn.push(input.value);\r\n    }\r\n\r\n    // MIDI devices that you send data to.\r\n    const outputs = midi.outputs.values();\r\n    for (let output = outputs.next(); output && !output.done; output = outputs.next()) {\r\n        midiOut.push(output.value);\r\n    }\r\n    for (const input of midiIn) {\r\n        input.addEventListener('midimessage', midiMessageReceived);\r\n    }\r\n}\r\n\r\n\r\nfunction midiMessageReceived(event) {\r\n    // MIDI commands we care about. See\r\n    // http://webaudio.github.io/web-midi-api/#a-simple-monophonic-sine-wave-midi-synthesizer.\r\n    const NOTE_ON = 9;\r\n    const NOTE_OFF = 8;\r\n    const PITCH_BEND = 0xE;\r\n    const AFTER_TOUCH = 0xD;\r\n    const CONTROL_CHANGE = 0xB;\r\n    const velocity = (event.data.length > 2) ? event.data[2] : 1;\r\n    const cmd = event.data[0] >> 4;\r\n    const channel = event.data[0] & 0x0F;\r\n    const value = event.data[1];\r\n    \r\n    // Note that not all MIDI controllers send a separate NOTE_OFF command for every NOTE_ON.\r\n    if (cmd === NOTE_OFF || (cmd === NOTE_ON && velocity === 0)) {\r\n        console.log(` from ${event.srcElement.name}, channel: ${channel}, note off: pitch:${value}`);\r\n        stopSoundWave(channel);\r\n    } \r\n    else if (cmd === NOTE_ON) {\r\n        console.log(` from ${event.srcElement.name}, channel: ${channel}, note on: pitch:${value}`);\r\n        playSoundWave(channel,note2Frequency(value));\r\n    }\r\n    else if (cmd === PITCH_BEND) {\r\n        const bend = ((event.data[2] << 7) + event.data[1] - 8192) / 8192;\r\n        // console.log(` from ${event.srcElement.name}, channel: ${channel}, pitch shift ${(bend * 12).toFixed(1)} semitones`);\r\n        pitchShift(channel, bend);\r\n    }\r\n    else if (cmd === AFTER_TOUCH) {\r\n        // console.log(` from ${event.srcElement.name}, channel: ${channel}, volume:${value}`);\r\n        volumeShift(channel, value);\r\n    }\r\n    else if (cmd === CONTROL_CHANGE) {\r\n\r\n        switch (value) {\r\n            case 2:\r\n                nPiontsCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 3:\r\n                cutoffCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 4:\r\n                resonanceCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 5:\r\n                attackCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 6:\r\n                decayCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 7:\r\n                delayTimeCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 8:\r\n                delayWetCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 9:\r\n                driveCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 10:\r\n                masterVolCC.forEach(fn => fn(velocity / 127));\r\n                break;\r\n            case 11:\r\n                console.log(`CC + 1`);\r\n                break;\r\n            case 12:\r\n                console.log(`CC - 1`);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function note2Frequency(note) {\r\n    return 440 * Math.pow(2,(note-69)/12);\r\n}\r\n","import { normaliseWave, getWaveFunction } from \"./wave-things.js\";\r\nimport FFT from './fft.js';\r\n\r\n\r\nlet audioContext = null;\r\nlet osc = [];\r\nlet gain = [];\r\nlet wave2 = null;\r\n\r\nlet Filter = null;\r\nlet Delay = null;\r\nlet DelayGain = null;\r\nlet DelayFeedback = null;\r\nlet Distortion = null;\r\nlet MasterVol = null;\r\n\r\nlet DistortionOn = false;\r\n\r\nlet attackTime = 0.1;\r\nlet decayTime = 0.5;\r\n\r\nexport function initAudioContext() {\r\n    if (audioContext === null) {   \r\n        audioContext = new AudioContext();\r\n    }\r\n\r\n    Filter = audioContext.createBiquadFilter();\r\n    Filter.type = \"lowpass\";\r\n    filterCutoff(1);\r\n    filterResonance(1);\r\n\r\n    Delay = audioContext.createDelay(5.0);\r\n    DelayFeedback = audioContext.createGain();\r\n    DelayGain = audioContext.createGain();\r\n    delayTime(0.3);\r\n    delayFeedback(0.8);\r\n    delayWet(0.3);\r\n\r\n    Distortion = audioContext.createWaveShaper();\r\n    drive(0);\r\n\r\n    MasterVol = audioContext.createGain();\r\n    masterVolume(0.75);\r\n\r\n    Distortion.connect(Filter);\r\n    Filter.connect(Delay);\r\n    Delay.connect(DelayGain);\r\n    DelayGain.connect(DelayFeedback);\r\n    DelayFeedback.connect(Delay);\r\n    DelayGain.connect(MasterVol);\r\n    Filter.connect(MasterVol);\r\n    \r\n    MasterVol.connect(audioContext.destination);\r\n}\r\n\r\nexport function updateBuffer(wave) {\r\n\r\n    if (wave.length > 0) {\r\n        const numPoints = wave.length;\r\n        const fft = new FFT(numPoints);\r\n    \r\n        const formatedPoints = fft.createComplexArray();\r\n        fft.toComplexArray(wave, formatedPoints);\r\n    \r\n        const out = fft.createComplexArray();\r\n        fft.transform(out, formatedPoints);\r\n        \r\n        const l = out.length/2\r\n\r\n        const real = new Float32Array(l);\r\n        const imag = new Float32Array(l);\r\n\r\n        for (let i = 0; i < l; i ++) {\r\n            real[i] = out[i*2];\r\n            imag[i] = out[i*2 + 1];\r\n        }\r\n        wave2 = audioContext.createPeriodicWave(real, imag);\r\n\r\n        for (let i = 0; i < 16; i ++) {\r\n            if(osc[i] != null){\r\n                osc[i].setPeriodicWave(wave2);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function playSoundWave(ch, pitch) {\r\n\r\n    osc[ch] = audioContext.createOscillator();\r\n    gain[ch] = audioContext.createGain();\r\n\r\n    osc[ch].setPeriodicWave(wave2);\r\n    \r\n\r\n    osc[ch].frequency.setValueAtTime(pitch, audioContext.currentTime);\r\n    \r\n    gain[ch].gain.setValueAtTime(0, audioContext.currentTime);\r\n    gain[ch].gain.linearRampToValueAtTime(0.5, audioContext.currentTime + attackTime);\r\n    gain[ch].gain.setTargetAtTime(0.5, audioContext.currentTime + attackTime, decayTime);\r\n\r\n    osc[ch].connect(gain[ch]);\r\n\r\n    if(DistortionOn){\r\n        gain[ch].connect(Distortion);\r\n    }\r\n    else{\r\n        gain[ch].connect(Filter);\r\n    }\r\n    \r\n    osc[ch].start();\r\n\r\n}\r\n\r\n\r\nexport function stopSoundWave(ch) {\r\n    if(osc[ch] != null){\r\n        gain[ch].gain.cancelScheduledValues(audioContext.currentTime);\r\n        gain[ch].gain.setValueAtTime(gain[ch].gain.value, audioContext.currentTime);\r\n        gain[ch].gain.linearRampToValueAtTime(0, audioContext.currentTime + decayTime);\r\n        osc[ch].stop(audioContext.currentTime + decayTime);\r\n        osc[ch] = null;\r\n    }\r\n}\r\n\r\nexport function attackTimeSet(value) {\r\n    value = Math.round(value * 200) / 100;\r\n    attackTime = value;\r\n    console.log(`Attack Time : ${attackTime}s`);\r\n}\r\n\r\nexport function decayTimeSet(value) {\r\n    value = Math.round(value * 200) / 100;\r\n    decayTime = value;\r\n    console.log(`Decay Time : ${decayTime}s`);\r\n}\r\n\r\nexport function pitchShift(ch, pitch) {\r\n    if(osc[ch] != null){\r\n        osc[ch].detune.setValueAtTime(pitch * 1200 * 2, audioContext.currentTime);\r\n    }\r\n}\r\n\r\nexport function volumeShift(ch, vol) {\r\n    if(osc[ch] != null){\r\n        // gain[ch].gain.setValueAtTime(vol / 127, audioContext.currentTime);\r\n        gain[ch].gain.linearRampToValueAtTime(vol / 127, audioContext.currentTime + attackTime);\r\n    }\r\n}\r\n\r\nexport function delayTime(time){\r\n    Delay.delayTime.setValueAtTime(time*2, audioContext.currentTime);\r\n    console.log(`Delay Time : ${Math.round(time*200)/100}s`);\r\n}\r\n\r\nfunction delayFeedback(value){\r\n    DelayFeedback.gain.setValueAtTime(value, audioContext.currentTime);\r\n}\r\n\r\nexport function delayWet(value){\r\n    DelayGain.gain.setValueAtTime(value, audioContext.currentTime);\r\n    console.log(`Delay Wet : ${Math.round(value*100)}%`);\r\n}\r\n\r\nexport function filterCutoff(value){\r\n    let freq = Math.round(Math.pow(10, value * 2) * 240);\r\n    Filter.frequency.value = freq;\r\n    console.log(`Filter Cut Off : ${freq}Hz`);\r\n}\r\n\r\nexport function filterResonance(value){\r\n    let Q =Math.round(((value * 20) + 1)*100) / 100;\r\n    Filter.Q.value = Q\r\n    console.log(`Filter Resonance : ${Q}`);\r\n}\r\n\r\nexport function masterVolume(value){\r\n    value = Math.round(value * 100) / 100;\r\n    MasterVol.gain.setValueAtTime(value, audioContext.currentTime);\r\n    console.log(`Master Volume : ${Math.round(value*100)}%`);\r\n}\r\n\r\n// async function createReverb() {\r\n//     let convolver = audioContext.createConvolver();\r\n  \r\n//     // load impulse response from file\r\n//     let response = await fetch(\"js/irRoom.wav\");\r\n//     let arraybuffer = await response.arrayBuffer();\r\n//     convolver.buffer = await audioContext.decodeAudioData(arraybuffer);\r\n  \r\n//     return convolver;\r\n// }\r\n\r\nexport function drive(amount) {\r\n    console.log(`Drive : ${Math.round(amount*100)}%`);\r\n    amount = Math.round(amount*500);\r\n    if(amount < 1){\r\n        DistortionOn = false;\r\n    }\r\n    else{\r\n        Distortion.curve = makeDistortionCurve(amount);\r\n        DistortionOn = true;\r\n    }\r\n}\r\n\r\nfunction makeDistortionCurve(amount) {\r\n    const k = typeof amount === \"number\" ? amount : 50;\r\n    const n_samples = 256;\r\n    const curve = new Float32Array(n_samples);\r\n    const deg = Math.PI / 180;\r\n  \r\n    for (let i = 0; i < n_samples; i++) {\r\n      const x = (i * 2) / n_samples - 1;\r\n      curve[i] = ((3 + k) * x * 20 * deg) / (Math.PI + k * Math.abs(x));\r\n    }\r\n    return curve;\r\n}\r\n","export function easeInOut(t, amt=2) {\r\n    let tPow = Math.pow(t, amt);\r\n    return tPow / (tPow + Math.pow(1 - t, amt));\r\n}\r\n\r\nexport function sinEaseInOut(t) {\r\n    return 0.5 - 0.5 * Math.cos(Math.PI * t);\r\n}\r\n\r\nexport function smallEaseInOut(t, a, b) {\r\n    // maximum slope, during the constant part\r\n    let m = 1 / (1 - a - b);\r\n\r\n    // f0\r\n    if (t < a) {\r\n        return 0;\r\n    }\r\n\r\n    // f1\r\n    if (t < b) {\r\n        return ((m / 2) / (b - a)) * (t - a) * (t - a);\r\n    }\r\n\r\n    // f2\r\n    if (t < 1 - b) {\r\n        return m * (t - b) + // constant line part\r\n        (m / 2) * (b - a); // maximum value of f1\r\n    }\r\n\r\n    // use symmetry powers\r\n    return 1 - smallEaseInOut(1 - t, a, b)\r\n}\r\n\r\nexport function slurp(val1, val2, amt) {\r\n    return (val2 - val1) * amt + val1;\r\n}\r\n\r\nexport function experp(val1, val2, amt) {\r\n    return Math.exp(\r\n        slurp(\r\n            Math.log(val1),\r\n            Math.log(val2),\r\n            amt\r\n        )\r\n    )\r\n}\r\n\r\nexport function clampedSlurp(val1, val2, amt) {\r\n    if (amt < 0) {\r\n        return val1;\r\n    }\r\n    if (amt > 1) {\r\n        return val2;\r\n    }\r\n    return slurp(val1, val2, amt);\r\n}\r\n\r\nexport function clamp(amt, val1, val2) {\r\n    if (amt < val1) {\r\n        return val1;\r\n    }\r\n    if (amt > val2) {\r\n        return val2;\r\n    }\r\n    return amt;\r\n}\r\n\r\n/**\r\n * Extracts a 0-1 interval from a section of a 0-1 interval\r\n *\r\n * For example, if min == 0.3 and max == 0.7, you get:\r\n *\r\n *           0.3  0.7\r\n *     t: 0 --+----+-- 1\r\n *           /      \\\r\n *          /        \\\r\n *         /          \\\r\n *     -> 0 ---------- 1\r\n *\r\n * Useful for making sub animations.\r\n *\r\n * Doesn't do any clamping, so you might want to clamp yourself.\r\n */\r\nexport function divideInterval(t, min, max) {\r\n    return (t - min) / (max - min);\r\n}\r\n\r\n/**\r\n * Does a positive modulo\r\n * @param {number} a The thing being modulo'd\r\n * @param {number} b The divider thing\r\n * @returns {number} a % b\r\n */\r\nexport function posMod(a, b) {\r\n    let out = a % b;\r\n    if (out < 0) {\r\n        out += b;\r\n    }\r\n    return out;\r\n}\r\n\r\n// TODO? Redesign so this generates a function?\r\nexport function to2dIsometric(x, y, z, xzAngle=0, yAngle=0) {\r\n    const mul = matrixMultiplication()(3);\r\n    // s/o to wikipedia for these rotation matrices\r\n    const xzRotateMatrix = [\r\n        Math.cos(xzAngle), 0, -Math.sin(xzAngle),\r\n        0, 1, 0,\r\n        Math.sin(xzAngle), 0, Math.cos(xzAngle)\r\n    ];\r\n    const yRotateMatrix = [\r\n        1, 0, 0,\r\n        0, Math.cos(yAngle), Math.sin(yAngle),\r\n        0, -Math.sin(yAngle), Math.cos(yAngle)\r\n    ];\r\n    const transformMatrix = mul(yRotateMatrix, xzRotateMatrix);\r\n\r\n    const transformed = mul(transformMatrix, [x, y, z]);\r\n    // Just return the x and y\r\n    return {x: transformed[0], y: transformed[1]};\r\n}","import { slurp } from \"./util.js\";\r\n\r\n// Generates a wave from a function in the range [0, 1)\r\nexport function getWave(fn, numSamples = 128) {\r\n    let points = [];\r\n    for (let i = 0; i < numSamples; i ++) {\r\n        const amt = i / numSamples;\r\n        points.push(fn(amt));\r\n    }\r\n    return points;\r\n}\r\n\r\n/**\r\n * @param {Array<number>} wave\r\n * @returns {Array<number>} Normalised wave (in the range -1 to 1)\r\n */\r\nexport function normaliseWave(wave) {\r\n    const min = Math.min(...wave);\r\n    const max = Math.max(...wave);\r\n    return wave.map(sample => slurp(-1, 1, (sample - min) / (max - min)));\r\n}\r\n\r\n/**\r\n * Creates a function that gives the value of a wave at a certain point. Does some interpolation.\r\n * @param {Array<number>} wave\r\n * @returns {function(number):number} A wave function (mainly to be used by the playSoundWave thing)\r\n */\r\nexport function getWaveFunction(wave) {\r\n    return t => {\r\n        t %= 1;\r\n        if (t < 0) {\r\n            t ++;\r\n        }\r\n        const index = Math.floor(wave.length * t);\r\n        const nextIndex = (index + 1) % wave.length;\r\n        // The remainder from doing the divide\r\n        const extra = (wave.length * t) % 1;\r\n\r\n        return slurp(wave[index], wave[nextIndex], extra);\r\n    }\r\n}\r\n\r\n\r\nexport function squareWave(t) {\r\n    // Do ya own normalising ya dangus\r\n    return t < 0.5 ? -1 : 1\r\n}\r\n\r\nexport function renderWave({context, wave, width, yPosition=0, yMultiple, startXAmt=0, type='wave'}) {\r\n    let startI = 0;\r\n    // (I think the wavelength of the wave can be configured by changing the 1 here)\r\n    const step = 1 / wave.length;\r\n    // TODO: Skip drawing the start things that are already defined.\r\n    for (let xAmt = startXAmt, i = startI; xAmt <= 1 + step; xAmt += step, i ++) {\r\n        const index = i % wave.length;\r\n\r\n        const x = width * xAmt;\r\n        const y = yPosition + yMultiple * wave[index];\r\n\r\n        if (type == 'wave') {\r\n            if (i == 0) {\r\n                context.moveTo(x, y);\r\n            }\r\n            else {\r\n                context.lineTo(x, y);\r\n            }\r\n        }\r\n        else if (type == 'samples') {\r\n            context.beginPath();\r\n            context.arc(x, y, 2, 0, 2 * Math.PI);\r\n            context.fill();\r\n        }\r\n    }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import Conductor from './conductor.js';\r\nimport WaveSplitController from './controller/wave-split-controller.js';\r\nimport WaveDrawController from './controller/wave-draw-controller.js';\r\n\r\nimport { stopSoundWave, playSoundWave, updateBuffer, initAudioContext, delayTime, delayWet\r\n, filterCutoff, filterResonance, drive, masterVolume, attackTimeSet, decayTimeSet } from './synth.js';\r\n\r\nimport { connectMidi, note2Frequency, nPiontsCC, cutoffCC, resonanceCC, delayTimeCC, delayWetCC,\r\n         attackCC, decayCC, driveCC, masterVolCC } from './midi.js';\r\nlet conductor = null;\r\n\r\nfunction init() {\r\n\r\n    let controllers = [];\r\n    let waveDrawController, waveDrawSplitController;\r\n\r\n    if (hasElement('wave-draw')) {\r\n        waveDrawController = new WaveDrawController('wave-draw');\r\n        controllers.push(waveDrawController);\r\n    }\r\n    if (hasElement('wave-draw-instruction')) {\r\n        const instruction = document.getElementById('wave-draw-instruction');\r\n        if (waveDrawController) {\r\n            waveDrawController.onDrawingStart.push(() => instruction.classList.add('hidden'))\r\n        }\r\n    }\r\n    if (hasElement('wave-draw-split')) {\r\n        waveDrawSplitController = new WaveSplitController('wave-draw-split');\r\n        if (waveDrawController != null) {\r\n            waveDrawController.onDrawingStart.push(() => {\r\n                waveDrawSplitController.splitAnim = true;\r\n                waveDrawSplitController.setPath([]);\r\n                waveDrawSplitController.fourierAmt = 1;\r\n                updateBuffer(waveDrawSplitController.partialWave);\r\n            });\r\n            waveDrawController.onDrawingEnd.push(() => {\r\n                waveDrawSplitController.splitAnim = true;\r\n                waveDrawSplitController.setPath(waveDrawController.normPath);\r\n                waveDrawSplitController.fourierAmt = 1;\r\n                updateBuffer(waveDrawSplitController.partialWave);\r\n            });\r\n            // Reset the nfft back to 1 when the wave changes to draw the full wave.\r\n            if (hasElement('knob-nfft')) {\r\n                let knob = document.getElementById(\"knob-nfft\")\r\n                \r\n                knob.min = 0\r\n                knob.max = 1.0\r\n                knob.value = 1\r\n                knob.step = 0.01\r\n                knob.tooltip = \"FFT points\"\r\n                knob.conv=\"(x*128).toFixed(0)\"\r\n                knob.addEventListener(\"input\", (event)=>{\r\n                    waveDrawSplitController.fourierAmt = event.target.value;\r\n                    waveDrawSplitController.splitAnim = false;\r\n                    updateBuffer(waveDrawSplitController.partialWave);\r\n                    console.log(`nFFT:${Math.round(event.target.value*128)}`);\r\n                });\r\n                nPiontsCC.push(val => {\r\n                    knob.value = val;\r\n                    waveDrawSplitController.fourierAmt = val;\r\n                    waveDrawSplitController.splitAnim = false;\r\n                    updateBuffer(waveDrawSplitController.partialWave);\r\n                    console.log(`nFFT:${Math.round(val*128)}`);\r\n                });\r\n                waveDrawController.onDrawingStart.push(() => {\r\n                    knob.value = 1;\r\n                    console.log(`nFFT:128`);\r\n                });\r\n                waveDrawController.onDrawingEnd.push(() => {\r\n                    knob.value = 1;\r\n                    console.log(`nFFT:128`);\r\n                });\r\n            }\r\n        }\r\n        controllers.push(waveDrawSplitController);\r\n    }\r\n\r\n    if (hasElement('knob-cutoff')) {\r\n        let knob = document.getElementById(\"knob-cutoff\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 1\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Cutoff\"\r\n        knob.conv=\"(Math.pow(10, x * 2) * 240).toFixed(0) + ' Hz'\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            filterCutoff(event.target.value);\r\n        });\r\n        cutoffCC.push(val => {\r\n            knob.value = val;\r\n            filterCutoff(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('knob-resonance')) {\r\n        let knob = document.getElementById(\"knob-resonance\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 1\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Resonance\"\r\n        knob.conv=\"((x * 20) + 1.0).toFixed(1)\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            filterResonance(event.target.value);\r\n        });\r\n        resonanceCC.push(val => {\r\n            knob.value = val;\r\n            filterResonance(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('knob-attack')) {\r\n        let knob = document.getElementById(\"knob-attack\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 0.05\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Attack\"\r\n        knob.conv=\"(x*2).toFixed(2)+ 's'\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            attackTimeSet(event.target.value);\r\n        });\r\n        attackCC.push(val => {\r\n            knob.value = val;\r\n            attackTimeSet(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('knob-decay')) {\r\n        let knob = document.getElementById(\"knob-decay\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 0.25\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Decay\"\r\n        knob.conv=\"(x*2).toFixed(2)+ 's'\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            decayTimeSet(event.target.value);\r\n        });\r\n        decayCC.push(val => {\r\n            knob.value = val;\r\n            decayTimeSet(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('knob-delay-time')) {\r\n        let knob = document.getElementById(\"knob-delay-time\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 0.3\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Delay Time\"\r\n        knob.conv=\"(x*2).toFixed(2)+ 's'\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            delayTime(event.target.value);\r\n        });\r\n        delayTimeCC.push(val => {\r\n            knob.value = val;\r\n            delayTime(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('knob-delay-wet')) {\r\n        let knob = document.getElementById(\"knob-delay-wet\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 0.3\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Delay Wet\"\r\n        knob.conv=\"(x*100).toFixed(0) + '%'\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            delayWet(event.target.value);\r\n        });\r\n        delayWetCC.push(val => {\r\n            knob.value = val;\r\n            delayWet(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('knob-drive')) {\r\n        let knob = document.getElementById(\"knob-drive\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 0\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Drive\"\r\n        knob.conv=\"(x*10).toFixed(1)\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            drive(event.target.value);\r\n        });\r\n        driveCC.push(val => {\r\n            knob.value = val;\r\n            drive(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('knob-master')) {\r\n        let knob = document.getElementById(\"knob-master\")\r\n        \r\n        knob.min = 0\r\n        knob.max = 1.0\r\n        knob.value = 0.75\r\n        knob.step = 0.01\r\n        knob.tooltip = \"Master Vol\"\r\n        knob.conv=\"(x*10).toFixed(1)\"\r\n        knob.addEventListener(\"input\", (event)=>{\r\n            masterVolume(event.target.value);\r\n        });\r\n        masterVolCC.push(val => {\r\n            knob.value = val;\r\n            masterVolume(val);\r\n        });\r\n    }\r\n\r\n    if (hasElement('keyboard')) {\r\n        let kb = document.getElementById(\"keyboard\")\r\n        kb.width = Math.round(window.innerWidth * 0.75)\r\n        kb.height = Math.round(window.innerHeight * 0.4)\r\n        console.log(window.innerWidth)\r\n        kb.addEventListener(\"change\",(event)=>{\r\n            let state = event.note[0]\r\n            let note = event.note[1]\r\n            if(state){\r\n                playSoundWave(note, note2Frequency(note));\r\n            }\r\n            else{\r\n                stopSoundWave(note);\r\n            }\r\n        });\r\n    }\r\n\r\n    initAudioContext();\r\n    connectMidi();\r\n\r\n    conductor = new Conductor(controllers);\r\n    conductor.start();\r\n    // To let me play around with things in the console.\r\n    window.conductor = conductor;\r\n}\r\n\r\nfunction hasElement(id) {\r\n    return document.getElementById(id) != null;\r\n}\r\n\r\ninit();"],"names":["clamp","rgb","r","g","b","grey","whiteAmt","whiteRgb","Math","floor","palette","black","blue","cyan","pink","orange","Conductor","constructor","controllers","lastTime","Date","now","mousePosition","slice","updatingControllers","document","addEventListener","evt","updateMousePosition","updateTouchPosition","window","onResize","start","requestAnimationFrame","everyFrame","forEach","controller","update","render","curTime","dt","isOnScreen","push","debug","getElementById","innerHTML","map","c","id","join","x","clientX","y","clientY","touches","length","elementInView","getScrollPosition","Controller","CanvasController","width","height","canvas","context","getContext","clear","resetTransform","clearRect","elem","boundingRect","getBoundingClientRect","centerY","top","bottom","windowHeight","innerHeight","documentElement","clientHeight","right","left","innerWidth","clientWidth","slurp","WaveDrawController","wavePoints","Array","fill","drawing","onDrawingStart","onDrawingEnd","lastMousePoint","startDrawing","stopDrawing","preventDefault","passive","normPath","el","fn","canvasPosition","actualWidth","scale","mousePoint","xDiff","abs","pointsGap","lerpPoints","ceil","i","amt","index","getNearestIndex","xAmt","pos","round","renderWave","beginPath","lineWidth","strokeStyle","moveTo","lineTo","stroke","getRealFourierData","transitionFactor","WaveSplitController","animAmt","partialWave","fourierPoints","onFourierChange","waveTop","waveBottom","totalHeight","fadeFrequencies","splitAnim","fourierAmt","setPath","path","pathAverage","reduce","a","p","fourierData","filter","f","amplitude","sort","min","max","splitAmt","period","desiredSplitAmt","renderWaves","numBabies","sizeMultiple","spacingMultiplier","curWavePos","startXAmt","fadeAmt","renderedBabies","babe","babeAmt","waveData","wavePosition","wave","iAmt","fullWaveAmt","sineAmt","cos","PI","freq","phase","globalAlpha","yPosition","yMultiple","size","Error","_csize","table","angle","sin","power","t","_width","_bitrev","j","shift","revShift","_out","_data","_inv","fromComplexArray","complex","storage","res","createComplexArray","toComplexArray","input","completeSpectrum","spectrum","half","transform","out","data","_transform4","realTransform","_realTransform4","inverseTransform","step","len","outOff","bitrev","off","_singleTransform2","_singleTransform4","inv","quarterLen","limit","k","A","B","C","D","Ar","Ai","Br","Bi","Cr","Ci","Dr","Di","MAr","MAi","tableBr","tableBi","MBr","MBi","tableCr","tableCi","MCr","MCi","tableDr","tableDi","MDr","MDi","T0r","T0i","T1r","T1i","T2r","T2i","T3r","T3i","FAr","FAi","FCr","FCi","FBr","FBi","FDr","FDi","evenR","evenI","oddR","oddI","leftR","leftI","rightR","rightI","step2","step3","_singleRealTransform2","_singleRealTransform4","halfLen","hquarterLen","ST0r","ST0i","ST1r","ST1i","ST2r","ST2i","ST3r","ST3i","SFAr","SFAi","SFBr","SFBi","SA","SB","FFT","getFourierData","points","numPoints","fft","fftData","sqrt","atan2","formatedPoints","resample2dData","numSamples","newPoints","position","nextIndex","getFourierRI","console","log","playSoundWave","stopSoundWave","pitchShift","volumeShift","nPiontsCC","cutoffCC","resonanceCC","delayTimeCC","delayWetCC","attackCC","decayCC","driveCC","masterVolCC","connectMidi","navigator","requestMIDIAccess","then","midi","midiReady","err","event","initDevices","target","midiIn","midiOut","inputs","values","next","done","value","outputs","output","midiMessageReceived","NOTE_ON","NOTE_OFF","PITCH_BEND","AFTER_TOUCH","CONTROL_CHANGE","velocity","cmd","channel","srcElement","name","note2Frequency","bend","note","pow","normaliseWave","getWaveFunction","audioContext","osc","gain","wave2","Filter","Delay","DelayGain","DelayFeedback","Distortion","MasterVol","DistortionOn","attackTime","decayTime","initAudioContext","AudioContext","createBiquadFilter","type","filterCutoff","filterResonance","createDelay","createGain","delayTime","delayFeedback","delayWet","createWaveShaper","drive","masterVolume","connect","destination","updateBuffer","l","real","Float32Array","imag","createPeriodicWave","setPeriodicWave","ch","pitch","createOscillator","frequency","setValueAtTime","currentTime","linearRampToValueAtTime","setTargetAtTime","cancelScheduledValues","stop","attackTimeSet","decayTimeSet","detune","vol","time","Q","amount","curve","makeDistortionCurve","n_samples","deg","easeInOut","tPow","sinEaseInOut","smallEaseInOut","m","val1","val2","experp","exp","clampedSlurp","divideInterval","posMod","to2dIsometric","z","xzAngle","yAngle","mul","matrixMultiplication","xzRotateMatrix","yRotateMatrix","transformMatrix","transformed","getWave","sample","extra","squareWave","startI","arc","conductor","init","waveDrawController","waveDrawSplitController","hasElement","instruction","classList","add","knob","tooltip","conv","val","kb","state"],"sourceRoot":""}